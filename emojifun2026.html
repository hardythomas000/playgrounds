<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Emoji Fun 2026</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: #f5f5f7;
            color: #1d1d1f;
            overflow-x: hidden;
            padding-bottom: 60px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .nav-container {
            position: sticky;
            top: 0;
            background: white;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        }

        .nav {
            display: flex;
            overflow-x: auto;
            padding: 10px;
            gap: 8px;
            -webkit-overflow-scrolling: touch;
        }

        .nav::-webkit-scrollbar {
            display: none;
        }

        .nav button {
            flex-shrink: 0;
            padding: 12px 20px;
            border: none;
            background: #e8e8ed;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            color: #1d1d1f;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .nav button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: scale(1.05);
        }

        .tab-content {
            display: none;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .controls {
            background: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .control-group {
            margin-bottom: 12px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .control-group label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 6px;
            color: #666;
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e8e8ed;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
        }

        select, input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #e8e8ed;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        select:focus, input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .button {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            transition: transform 0.2s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .button:active {
            transform: scale(0.98);
        }

        .emoji-grid {
            display: grid;
            gap: 2px;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            overflow: hidden;
        }

        .emoji-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            background: white;
        }

        .slot-machine {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            background: white;
            padding: 30px 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .reel {
            width: 80px;
            height: 120px;
            background: linear-gradient(to bottom, #f0f0f5, #e8e8ed);
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.1);
        }

        .reel-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: transform 0.5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        .reel-content.spinning {
            transition: transform 2s cubic-bezier(0.33, 1, 0.68, 1);
        }

        .reel-item {
            width: 100%;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
        }

        .rain-container {
            position: relative;
            width: 100%;
            height: 400px;
            background: linear-gradient(to bottom, #87CEEB, #E0F6FF);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .rain-emoji {
            position: absolute;
            animation: fall linear infinite;
            pointer-events: none;
        }

        @keyframes fall {
            to {
                transform: translateY(400px);
            }
        }

        @keyframes rotate {
            to {
                transform: translateY(400px) rotate(360deg);
            }
        }

        .animator-gallery {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .animation-box {
            background: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .animation-box .emoji {
            font-size: 48px;
            display: inline-block;
        }

        .animation-box .label {
            margin-top: 10px;
            font-size: 13px;
            font-weight: 600;
            color: #666;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        @keyframes flip {
            0% { transform: rotateY(0); }
            100% { transform: rotateY(360deg); }
        }

        @keyframes swing {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(15deg); }
            75% { transform: rotate(-15deg); }
        }

        @keyframes jello {
            0%, 100% { transform: skewX(0deg); }
            25% { transform: skewX(-12.5deg); }
            50% { transform: skewX(6.25deg); }
            75% { transform: skewX(-3.125deg); }
        }

        .bounce { animation: bounce 1s infinite; }
        .spin { animation: spin 2s linear infinite; }
        .pulse { animation: pulse 1s infinite; }
        .shake { animation: shake 0.5s infinite; }
        .float { animation: float 2s ease-in-out infinite; }
        .flip { animation: flip 2s linear infinite; }
        .swing { animation: swing 1s ease-in-out infinite; }
        .jello { animation: jello 1s infinite; }

        .combiner {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            text-align: center;
            margin-bottom: 15px;
        }

        .combiner-input {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .combiner-emoji {
            font-size: 64px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .combiner-emoji:active {
            transform: scale(0.9);
        }

        .combiner-result {
            font-size: 18px;
            font-weight: 600;
            color: #667eea;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f0f0f5;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .preset-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .preset-item {
            background: #f0f0f5;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .preset-item:active {
            transform: scale(0.98);
            background: #e8e8ed;
        }

        .preset-emoji {
            font-size: 32px;
            margin-bottom: 5px;
        }

        .preset-text {
            font-size: 12px;
            font-weight: 600;
            color: #666;
        }

        .reaction-board {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .message-display {
            background: #f0f0f5;
            padding: 20px;
            border-radius: 10px;
            font-size: 18px;
            text-align: center;
            margin-bottom: 15px;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .reaction-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-top: 15px;
        }

        .reaction-emoji {
            font-size: 36px;
            padding: 10px;
            background: #f0f0f5;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.1s ease;
        }

        .reaction-emoji:active {
            transform: scale(0.9);
        }

        .reaction-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .floating-reaction {
            position: absolute;
            font-size: 48px;
            animation: floatUp 2s ease-out forwards;
            pointer-events: none;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(0.5);
                opacity: 1;
            }
            100% {
                transform: translateY(-200px) scale(1.5);
                opacity: 0;
            }
        }

        .emoji-picker {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            margin-bottom: 15px;
        }

        .emoji-picker-item {
            font-size: 32px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .emoji-picker-item:active {
            transform: scale(0.9);
            background: #f0f0f5;
        }

        .emoji-picker-item.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transform: scale(1.1);
        }

        .stats {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            text-align: center;
            margin-bottom: 15px;
        }

        .stats-number {
            font-size: 36px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stats-label {
            font-size: 13px;
            color: #666;
            margin-top: 5px;
        }

        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti-piece {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #667eea;
            animation: confettiFall 3s linear forwards;
        }

        @keyframes confettiFall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .value-display {
            display: inline-block;
            min-width: 40px;
            text-align: right;
            font-weight: 600;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üé® Emoji Fun 2026</h1>
        <p>Interactive emoji playground</p>
    </div>

    <div class="nav-container">
        <div class="nav">
            <button class="tab-btn active" data-tab="mosaic">üé® Mosaic</button>
            <button class="tab-btn" data-tab="slots">üé∞ Slot Machine</button>
            <button class="tab-btn" data-tab="rain">üåßÔ∏è Emoji Rain</button>
            <button class="tab-btn" data-tab="animator">‚ú® Animator</button>
            <button class="tab-btn" data-tab="combiner">üîÄ Combiner</button>
            <button class="tab-btn" data-tab="reactions">üí¨ Reactions</button>
        </div>
    </div>

    <!-- Tab 1: Emoji Mosaic -->
    <div class="tab-content active" id="mosaic">
        <div class="controls">
            <div class="control-group">
                <label>Grid Size: <span class="value-display" id="gridSizeValue">16</span></label>
                <input type="range" id="gridSize" min="8" max="24" value="16" step="2">
            </div>
            <div class="control-group">
                <label>Source Image</label>
                <select id="sourceImage">
                    <option value="sunset">Sunset</option>
                    <option value="ocean">Ocean</option>
                    <option value="forest">Forest</option>
                    <option value="rainbow">Rainbow</option>
                    <option value="fire">Fire</option>
                </select>
            </div>
            <button class="button" onclick="generateMosaic()">Generate Mosaic</button>
            <button class="button" onclick="copyMosaic()" style="margin-top: 10px; background: #34c759;">Copy as Text</button>
        </div>
        <div class="emoji-grid" id="mosaicGrid"></div>
    </div>

    <!-- Tab 2: Slot Machine -->
    <div class="tab-content" id="slots">
        <div class="stats">
            <div class="stats-number" id="winCount">0</div>
            <div class="stats-label">WINS</div>
        </div>
        <div class="controls">
            <div class="control-group">
                <label>Spin Speed</label>
                <select id="spinSpeed">
                    <option value="1">Slow</option>
                    <option value="1.5" selected>Medium</option>
                    <option value="2.5">Fast</option>
                </select>
            </div>
            <div class="control-group">
                <label>Reel Set</label>
                <select id="reelSet">
                    <option value="fruits">Fruits</option>
                    <option value="animals">Animals</option>
                    <option value="faces">Faces</option>
                    <option value="mixed" selected>Mixed</option>
                </select>
            </div>
        </div>
        <div class="slot-machine">
            <div class="reel">
                <div class="reel-content" id="reel1"></div>
            </div>
            <div class="reel">
                <div class="reel-content" id="reel2"></div>
            </div>
            <div class="reel">
                <div class="reel-content" id="reel3"></div>
            </div>
        </div>
        <div class="controls">
            <button class="button" onclick="pullSlots()">üé∞ PULL</button>
        </div>
    </div>

    <!-- Tab 3: Emoji Rain -->
    <div class="tab-content" id="rain">
        <div class="controls">
            <div class="control-group">
                <label>Select Emoji</label>
                <div class="emoji-picker" id="rainEmojiPicker"></div>
            </div>
            <div class="control-group">
                <label>Fall Speed: <span class="value-display" id="rainSpeedValue">5</span>s</label>
                <input type="range" id="rainSpeed" min="2" max="10" value="5" step="1">
            </div>
            <div class="control-group">
                <label>Density: <span class="value-display" id="rainDensityValue">5</span></label>
                <input type="range" id="rainDensity" min="1" max="10" value="5" step="1">
            </div>
            <div class="control-group">
                <label>Size: <span class="value-display" id="rainSizeValue">32</span>px</label>
                <input type="range" id="rainSize" min="20" max="64" value="32" step="4">
            </div>
            <div class="control-group">
                <label>
                    <input type="checkbox" id="rainRotate"> Rotation
                </label>
            </div>
        </div>
        <div class="rain-container" id="rainContainer"></div>
    </div>

    <!-- Tab 4: Icon Animator -->
    <div class="tab-content" id="animator">
        <div class="controls">
            <div class="control-group">
                <label>Select Emoji</label>
                <div class="emoji-picker" id="animatorEmojiPicker"></div>
            </div>
            <div class="control-group">
                <label>Animation Speed: <span class="value-display" id="animSpeedValue">1.0</span>x</label>
                <input type="range" id="animSpeed" min="0.5" max="2" value="1" step="0.1">
            </div>
            <div class="control-group">
                <label>Size: <span class="value-display" id="animSizeValue">48</span>px</label>
                <input type="range" id="animSize" min="32" max="96" value="48" step="8">
            </div>
        </div>
        <div class="animator-gallery" id="animatorGallery"></div>
    </div>

    <!-- Tab 5: Emoji Combiner -->
    <div class="tab-content" id="combiner">
        <div class="combiner">
            <div class="combiner-input">
                <div class="combiner-emoji" id="emoji1" onclick="randomizeEmoji('emoji1')">üî•</div>
                <div style="font-size: 32px; color: #667eea;">+</div>
                <div class="combiner-emoji" id="emoji2" onclick="randomizeEmoji('emoji2')">‚ùÑÔ∏è</div>
            </div>
            <button class="button" onclick="combineEmojis()">Combine!</button>
            <div class="combiner-result" id="combinerResult">Tap Combine to see the result!</div>
        </div>

        <div class="controls">
            <label style="display: block; font-weight: 600; margin-bottom: 10px;">‚ú® Preset Combos</label>
            <div class="preset-grid" id="presetGrid"></div>
        </div>
    </div>

    <!-- Tab 6: Reaction Board -->
    <div class="tab-content" id="reactions">
        <div class="reaction-board">
            <div class="controls">
                <div class="control-group">
                    <label>Message</label>
                    <input type="text" id="messageInput" placeholder="Type your message..." value="This is awesome!">
                </div>
            </div>
            <div class="message-display" id="messageDisplay">This is awesome!</div>
            <div class="reaction-grid" id="reactionGrid"></div>
        </div>
    </div>

    <div class="reaction-overlay" id="reactionOverlay"></div>
    <div class="confetti" id="confetti"></div>

    <script>
        // Global state
        let winCount = 0;
        let rainInterval = null;
        let currentRainEmoji = 'üòÄ';
        let currentAnimatorEmoji = 'üòÄ';

        // Emoji collections
        const emojiSets = {
            fruits: ['üçé', 'üçä', 'üçã', 'üçå', 'üçâ', 'üçá', 'üçì', 'üçí'],
            animals: ['üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº'],
            faces: ['üòÄ', 'üòÅ', 'üòÇ', 'ü§£', 'üòÉ', 'üòÑ', 'üòÖ', 'üòÜ'],
            mixed: ['üé®', 'üé≠', 'üé™', 'üé°', 'üé¢', 'üéØ', 'üé≤', 'üé∞']
        };

        const popularEmojis = ['üòÄ', 'üòÇ', 'ü•∞', 'üòé', 'ü§î', 'üò±', 'ü•≥', 'üò¥',
                               'üî•', '‚≠ê', 'üíñ', 'üëç', 'üéâ', 'üåà', 'ü¶Ñ', 'üçï'];

        const reactionEmojis = ['‚ù§Ô∏è', 'üëç', 'üòÇ', 'üòÆ', 'üò¢', 'üî•', 'üéâ', 'üëè',
                                'üíØ', '‚≠ê', 'üëÄ', 'üí™', 'üôå', '‚ú®', 'üíñ', 'üéØ'];

        const colorEmojis = {
            red: ['üî¥', '‚ù§Ô∏è', 'üåπ', 'üçé', 'üçì', 'üî•', 'üíã'],
            orange: ['üü†', 'üß°', 'üçä', 'üåÖ', 'ü¶ä', 'ü•ï', 'ü¶ê'],
            yellow: ['üü°', 'üíõ', '‚≠ê', 'üåü', 'üåª', 'üçã', 'üçå'],
            green: ['üü¢', 'üíö', 'üå≤', 'üçÄ', 'ü•í', 'üê∏', 'üåø'],
            blue: ['üîµ', 'üíô', 'üåä', 'üíé', 'üêü', 'ü´ê', 'ü¶ã'],
            purple: ['üü£', 'üíú', 'üçá', 'üëæ', 'ü¶Ñ', 'üîÆ', 'üå∏'],
            white: ['‚ö™', 'ü§ç', '‚òÅÔ∏è', 'üèê', 'ü••', '‚ö°', '‚ùÑÔ∏è'],
            black: ['‚ö´', 'üñ§', 'üé±', 'ü¶á', 'üêß', 'üé©', 'üï∑Ô∏è']
        };

        const combos = [
            {e1: 'üî•', e2: '‚ùÑÔ∏è', result: 'Frostfire - eternal struggle of hot and cold!'},
            {e1: 'üåà', e2: 'ü¶Ñ', result: 'Magical Rainbow Unicorn - double the magic!'},
            {e1: 'üçï', e2: 'üçî', result: 'Ultimate Junk Food - the perfect cheat meal!'},
            {e1: '‚òï', e2: 'üí§', result: 'Coffee Zombie - needs more caffeine!'},
            {e1: 'üéÆ', e2: 'üïê', result: 'Time Warp Gaming - where did the day go?'},
            {e1: 'üê∂', e2: 'üê±', result: 'Eternal Frenemies - peace was never an option!'},
            {e1: 'üí™', e2: 'üç©', result: 'Gym Regret - I deserve this treat!'},
            {e1: 'üåô', e2: '‚òÄÔ∏è', result: 'Eclipse - when day meets night!'},
            {e1: 'üéµ', e2: 'üò¥', result: 'Lullaby - sweet dreams ahead!'},
            {e1: 'üöÄ', e2: 'üåü', result: 'Space Explorer - to infinity and beyond!'},
            {e1: 'üé®', e2: 'üí°', result: 'Creative Genius - when art meets ideas!'},
            {e1: 'üìö', e2: 'üß†', result: 'Knowledge Power - feed your brain!'},
            {e1: 'üç∫', e2: 'üéâ', result: 'Party Mode - let the fun begin!'},
            {e1: 'üíª', e2: '‚òï', result: 'Developer Fuel - code and caffeine!'},
            {e1: 'üèÉ', e2: 'üçï', result: 'Exercise Excuse - I earned this!'},
            {e1: 'üé≠', e2: 'üé™', result: 'Showtime - all the world\'s a stage!'},
            {e1: 'üåä', e2: 'üèÑ', result: 'Wave Rider - surf\'s up!'},
            {e1: 'üéØ', e2: 'üèÜ', result: 'Winner - hit that bullseye!'},
            {e1: 'üåÆ', e2: 'üåØ', result: 'Mexican Feast - taco Tuesday everyday!'},
            {e1: 'üé∏', e2: 'üîä', result: 'Rock Star - turn it up to 11!'}
        ];

        // Initialize tabs
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tabName = btn.dataset.tab;
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById(tabName).classList.add('active');

                if (tabName === 'rain' && !rainInterval) {
                    startRain();
                } else if (tabName !== 'rain' && rainInterval) {
                    stopRain();
                }
            });
        });

        // Update value displays
        document.querySelectorAll('input[type="range"]').forEach(input => {
            input.addEventListener('input', (e) => {
                const valueDisplay = document.getElementById(e.target.id + 'Value');
                if (valueDisplay) {
                    valueDisplay.textContent = e.target.value;
                }

                if (e.target.id.startsWith('rain')) {
                    stopRain();
                    startRain();
                }
            });
        });

        // Mosaic functions
        function generateMosaic() {
            const size = parseInt(document.getElementById('gridSize').value);
            const source = document.getElementById('sourceImage').value;
            const grid = document.getElementById('mosaicGrid');

            grid.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
            grid.innerHTML = '';

            const colors = getGradientColors(source, size);

            for (let i = 0; i < size * size; i++) {
                const cell = document.createElement('div');
                cell.className = 'emoji-cell';
                const emoji = getClosestEmoji(colors[i]);
                cell.textContent = emoji;
                grid.appendChild(cell);
            }
        }

        function getGradientColors(type, size) {
            const colors = [];
            const total = size * size;

            for (let i = 0; i < total; i++) {
                const row = Math.floor(i / size);
                const col = i % size;
                const xPercent = col / (size - 1);
                const yPercent = row / (size - 1);

                let color;
                switch(type) {
                    case 'sunset':
                        color = interpolateColor('#FF6B35', '#F7931E', '#FDC830', yPercent);
                        break;
                    case 'ocean':
                        color = interpolateColor('#0077BE', '#00B4D8', '#90E0EF', yPercent);
                        break;
                    case 'forest':
                        color = interpolateColor('#1B4D3E', '#2D6A4F', '#52B788', yPercent);
                        break;
                    case 'rainbow':
                        const hue = xPercent * 360;
                        color = `hsl(${hue}, 70%, 60%)`;
                        break;
                    case 'fire':
                        color = interpolateColor('#8B0000', '#FF4500', '#FFD700', yPercent);
                        break;
                }
                colors.push(color);
            }
            return colors;
        }

        function interpolateColor(color1, color2, color3, percent) {
            if (percent < 0.5) {
                return interpolate2Colors(color1, color2, percent * 2);
            } else {
                return interpolate2Colors(color2, color3, (percent - 0.5) * 2);
            }
        }

        function interpolate2Colors(c1, c2, percent) {
            const r1 = parseInt(c1.slice(1, 3), 16);
            const g1 = parseInt(c1.slice(3, 5), 16);
            const b1 = parseInt(c1.slice(5, 7), 16);
            const r2 = parseInt(c2.slice(1, 3), 16);
            const g2 = parseInt(c2.slice(3, 5), 16);
            const b2 = parseInt(c2.slice(5, 7), 16);

            const r = Math.round(r1 + (r2 - r1) * percent);
            const g = Math.round(g1 + (g2 - g1) * percent);
            const b = Math.round(b1 + (b2 - b1) * percent);

            return `rgb(${r}, ${g}, ${b})`;
        }

        function getClosestEmoji(color) {
            const rgb = color.match(/\d+/g).map(Number);
            const [r, g, b] = rgb;

            const hsl = rgbToHsl(r, g, b);
            const hue = hsl[0];
            const lightness = hsl[2];

            if (lightness > 80) return colorEmojis.white[Math.floor(Math.random() * colorEmojis.white.length)];
            if (lightness < 20) return colorEmojis.black[Math.floor(Math.random() * colorEmojis.black.length)];

            if (hue < 30) return colorEmojis.red[Math.floor(Math.random() * colorEmojis.red.length)];
            if (hue < 60) return colorEmojis.orange[Math.floor(Math.random() * colorEmojis.orange.length)];
            if (hue < 90) return colorEmojis.yellow[Math.floor(Math.random() * colorEmojis.yellow.length)];
            if (hue < 180) return colorEmojis.green[Math.floor(Math.random() * colorEmojis.green.length)];
            if (hue < 270) return colorEmojis.blue[Math.floor(Math.random() * colorEmojis.blue.length)];
            if (hue < 330) return colorEmojis.purple[Math.floor(Math.random() * colorEmojis.purple.length)];
            return colorEmojis.red[Math.floor(Math.random() * colorEmojis.red.length)];
        }

        function rgbToHsl(r, g, b) {
            r /= 255; g /= 255; b /= 255;
            const max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                switch (max) {
                    case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                    case g: h = ((b - r) / d + 2) / 6; break;
                    case b: h = ((r - g) / d + 4) / 6; break;
                }
            }

            return [h * 360, s * 100, l * 100];
        }

        function copyMosaic() {
            const grid = document.getElementById('mosaicGrid');
            const size = parseInt(document.getElementById('gridSize').value);
            let text = '';

            Array.from(grid.children).forEach((cell, i) => {
                text += cell.textContent;
                if ((i + 1) % size === 0) text += '\n';
            });

            navigator.clipboard.writeText(text).then(() => {
                alert('Mosaic copied to clipboard!');
            });
        }

        // Slot machine functions
        function initSlots() {
            updateReels();
        }

        function updateReels() {
            const reelSet = document.getElementById('reelSet').value;
            const emojis = emojiSets[reelSet];

            for (let i = 1; i <= 3; i++) {
                const reel = document.getElementById(`reel${i}`);
                reel.innerHTML = '';

                for (let j = 0; j < 20; j++) {
                    const item = document.createElement('div');
                    item.className = 'reel-item';
                    item.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                    reel.appendChild(item);
                }
            }
        }

        function pullSlots() {
            updateReels();
            const speed = parseFloat(document.getElementById('spinSpeed').value);
            const results = [];

            for (let i = 1; i <= 3; i++) {
                const reel = document.getElementById(`reel${i}`);
                const items = reel.children;
                const randomStop = Math.floor(Math.random() * (items.length - 3));
                const offset = -(randomStop * 80 + 20);

                reel.classList.add('spinning');
                reel.style.transitionDuration = `${2 / speed}s`;
                reel.style.transform = `translateY(${offset}px)`;

                results.push(items[randomStop + 1].textContent);
            }

            setTimeout(() => {
                document.querySelectorAll('.reel-content').forEach(reel => {
                    reel.classList.remove('spinning');
                });

                if (results[0] === results[1] && results[1] === results[2]) {
                    winCount++;
                    document.getElementById('winCount').textContent = winCount;
                    showConfetti();
                }
            }, 2000 / speed);
        }

        function showConfetti() {
            const container = document.getElementById('confetti');
            const colors = ['#667eea', '#764ba2', '#f093fb', '#4facfe', '#43e97b'];

            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti-piece';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 0.5 + 's';
                container.appendChild(confetti);

                setTimeout(() => confetti.remove(), 3000);
            }
        }

        // Rain functions
        function initRainPicker() {
            const picker = document.getElementById('rainEmojiPicker');
            popularEmojis.forEach((emoji, index) => {
                const item = document.createElement('div');
                item.className = 'emoji-picker-item';
                if (index === 0) item.classList.add('selected');
                item.textContent = emoji;
                item.addEventListener('click', () => {
                    document.querySelectorAll('#rainEmojiPicker .emoji-picker-item').forEach(el => {
                        el.classList.remove('selected');
                    });
                    item.classList.add('selected');
                    currentRainEmoji = emoji;
                    stopRain();
                    startRain();
                });
                picker.appendChild(item);
            });
        }

        function startRain() {
            const container = document.getElementById('rainContainer');
            const speed = parseInt(document.getElementById('rainSpeed').value);
            const density = parseInt(document.getElementById('rainDensity').value);
            const size = parseInt(document.getElementById('rainSize').value);
            const rotate = document.getElementById('rainRotate').checked;

            rainInterval = setInterval(() => {
                for (let i = 0; i < density; i++) {
                    const emoji = document.createElement('div');
                    emoji.className = 'rain-emoji';
                    emoji.textContent = currentRainEmoji;
                    emoji.style.left = Math.random() * 100 + '%';
                    emoji.style.fontSize = size + 'px';
                    emoji.style.animationDuration = speed + 's';
                    emoji.style.animationName = rotate ? 'rotate' : 'fall';
                    container.appendChild(emoji);

                    setTimeout(() => emoji.remove(), speed * 1000);
                }
            }, 500);
        }

        function stopRain() {
            if (rainInterval) {
                clearInterval(rainInterval);
                rainInterval = null;
            }
            document.getElementById('rainContainer').innerHTML = '';
        }

        document.getElementById('rainRotate').addEventListener('change', () => {
            stopRain();
            startRain();
        });

        // Animator functions
        function initAnimatorPicker() {
            const picker = document.getElementById('animatorEmojiPicker');
            popularEmojis.forEach((emoji, index) => {
                const item = document.createElement('div');
                item.className = 'emoji-picker-item';
                if (index === 0) item.classList.add('selected');
                item.textContent = emoji;
                item.addEventListener('click', () => {
                    document.querySelectorAll('#animatorEmojiPicker .emoji-picker-item').forEach(el => {
                        el.classList.remove('selected');
                    });
                    item.classList.add('selected');
                    currentAnimatorEmoji = emoji;
                    updateAnimatorGallery();
                });
                picker.appendChild(item);
            });
        }

        function updateAnimatorGallery() {
            const gallery = document.getElementById('animatorGallery');
            const speed = parseFloat(document.getElementById('animSpeed').value);
            const size = parseInt(document.getElementById('animSize').value);

            const animations = ['bounce', 'spin', 'pulse', 'shake', 'float', 'flip', 'swing', 'jello'];
            const labels = ['Bounce', 'Spin', 'Pulse', 'Shake', 'Float', 'Flip', 'Swing', 'Jello'];

            gallery.innerHTML = '';

            animations.forEach((anim, index) => {
                const box = document.createElement('div');
                box.className = 'animation-box';

                const emoji = document.createElement('div');
                emoji.className = `emoji ${anim}`;
                emoji.textContent = currentAnimatorEmoji;
                emoji.style.fontSize = size + 'px';
                emoji.style.animationDuration = anim === 'spin' ? (2 / speed) + 's' : (1 / speed) + 's';

                const label = document.createElement('div');
                label.className = 'label';
                label.textContent = labels[index];

                box.appendChild(emoji);
                box.appendChild(label);
                gallery.appendChild(box);
            });
        }

        document.getElementById('animSpeed').addEventListener('input', updateAnimatorGallery);
        document.getElementById('animSize').addEventListener('input', updateAnimatorGallery);

        // Combiner functions
        function initCombiner() {
            const grid = document.getElementById('presetGrid');
            combos.slice(0, 20).forEach(combo => {
                const item = document.createElement('div');
                item.className = 'preset-item';
                item.innerHTML = `
                    <div class="preset-emoji">${combo.e1} + ${combo.e2}</div>
                    <div class="preset-text">${combo.result.split('-')[0].trim()}</div>
                `;
                item.addEventListener('click', () => {
                    document.getElementById('emoji1').textContent = combo.e1;
                    document.getElementById('emoji2').textContent = combo.e2;
                    document.getElementById('combinerResult').textContent = combo.result;
                });
                grid.appendChild(item);
            });
        }

        function randomizeEmoji(id) {
            const allEmojis = [...popularEmojis, ...emojiSets.fruits, ...emojiSets.animals];
            const emoji = allEmojis[Math.floor(Math.random() * allEmojis.length)];
            document.getElementById(id).textContent = emoji;
        }

        function combineEmojis() {
            const e1 = document.getElementById('emoji1').textContent;
            const e2 = document.getElementById('emoji2').textContent;

            const existing = combos.find(c => (c.e1 === e1 && c.e2 === e2) || (c.e1 === e2 && c.e2 === e1));

            if (existing) {
                document.getElementById('combinerResult').textContent = existing.result;
            } else {
                const results = [
                    'A match made in emoji heaven!',
                    'Strange but oddly satisfying!',
                    'This combination defies logic!',
                    'The universe approves!',
                    'Chaos and beauty combined!',
                    'Perfectly balanced, as all things should be!',
                    'An unexpected masterpiece!',
                    'This might break reality!',
                    'The ultimate crossover!',
                    'Pure creative genius!'
                ];
                document.getElementById('combinerResult').textContent =
                    `${e1} + ${e2} = ${results[Math.floor(Math.random() * results.length)]}`;
            }
        }

        // Reaction board functions
        function initReactions() {
            const grid = document.getElementById('reactionGrid');
            reactionEmojis.forEach(emoji => {
                const item = document.createElement('div');
                item.className = 'reaction-emoji';
                item.textContent = emoji;
                item.addEventListener('click', (e) => {
                    createFloatingReaction(emoji, e.clientX, e.clientY);
                });
                grid.appendChild(item);
            });

            document.getElementById('messageInput').addEventListener('input', (e) => {
                document.getElementById('messageDisplay').textContent = e.target.value || 'Type a message...';
            });
        }

        function createFloatingReaction(emoji, x, y) {
            const overlay = document.getElementById('reactionOverlay');
            const reaction = document.createElement('div');
            reaction.className = 'floating-reaction';
            reaction.textContent = emoji;
            reaction.style.left = x + 'px';
            reaction.style.top = y + 'px';
            overlay.appendChild(reaction);

            setTimeout(() => reaction.remove(), 2000);
        }

        // Initialize everything
        document.addEventListener('DOMContentLoaded', () => {
            generateMosaic();
            initSlots();
            initRainPicker();
            initAnimatorPicker();
            updateAnimatorGallery();
            initCombiner();
            initReactions();
            startRain();
        });

        // Update grid size value display
        document.getElementById('gridSize').addEventListener('input', (e) => {
            document.getElementById('gridSizeValue').textContent = e.target.value;
        });

        // Update select for reel set
        document.getElementById('reelSet').addEventListener('change', updateReels);
    </script>
</body>
</html>